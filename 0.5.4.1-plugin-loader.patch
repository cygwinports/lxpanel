--- origsrc/lxpanel-0.5.4.1/src/plugin.c	2009-07-25 21:01:54.000000000 -0500
+++ src/lxpanel-0.5.4.1/src/plugin.c	2010-02-10 01:01:28.403648600 -0600
@@ -139,7 +139,7 @@ static PluginClass * plugin_load_dynamic
         || (strcmp(type, pc->type) != 0))			/* Then and only then access other fields; check name */
         {
             g_module_close(m);
-            ERR("%s.so is not a lxpanel plugin\n", type);
+            ERR("%s.%s is not a lxpanel plugin\n", type, G_MODULE_SUFFIX);
             return NULL;
         }
 
@@ -165,7 +165,7 @@ Plugin * plugin_load(char * type)
     if ((pc == NULL) && (g_module_supported()))
     {
         gchar path[PATH_MAX];
-        g_snprintf(path, sizeof(path), PACKAGE_LIB_DIR "/lxpanel/plugins/%s.so", type);
+        g_snprintf(path, sizeof(path), PACKAGE_LIB_DIR "/lxpanel/plugins/%s.%s", type, G_MODULE_SUFFIX);
         pc = plugin_load_dynamic(type, path);
     }
 #endif  /* DISABLE_PLUGINS_LOADING */
@@ -280,9 +280,9 @@ GList * plugin_get_available_classes(voi
         const char * file;
         while ((file = g_dir_read_name(dir)) != NULL)
         {
-            if (g_str_has_suffix(file, ".so"))
+            if (g_str_has_suffix(file, "."G_MODULE_SUFFIX))
             {
-                char * type = g_strndup(file, strlen(file) - 3);
+                char * type = g_strndup(file, strlen(file) - strlen("."G_MODULE_SUFFIX));
                 if (plugin_find_class(type) == NULL)
                 {
                     /* If it has not been loaded, do it.  If successful, add it to the result. */
